rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /{collection}/{document} {
      allow create:
        if request.auth.uid == request.resource.data.owner

        && (collection != "Person"
            || request.resource.data.owner == request.resource.data.id)
      allow update:
        if request.auth.uid == resource.data.owner
        && request.auth.uid == request.resource.data.owner

        && (collection != "Person"
            || request.resource.data.owner == request.resource.data.id)
      allow get, delete:
        if resource == null
        || request.auth.uid == resource.data.owner
      allow list:
        if collection == "XfCard"
    }
  }
}
